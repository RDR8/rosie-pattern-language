FROM centos
ARG branch

RUN yum -y update && yum install -y epel-release
RUN yum install -y \
  gcc \
  git \
  make \
  python \
  python-pip \
  readline \
  readline-devel 

RUN pip install --upgrade pip
RUN pip install cffi

RUN git clone --recursive --branch $branch https://github.com/jamiejennings/rosie-pattern-language.git /opt/rosie

WORKDIR /opt/rosie
RUN make && make install
RUN make test CLIENTS=all

