.mso www.tmac
.TH ROSIE 1 "$Date: 2018/02/20 09:00:00 $"
.SH NAME
rosie \- Rosie Pattern Engine (Rosie Pattern Language)
.SH SYNOPSIS
.B rosie
[
.I global-options
]
.I command
[
.I command-options
]
.I pattern-expression
.I file
.I [...]
.SH DESCRIPTION
.B Rosie
searches all given input files for lines that match a pattern.  The pattern
language is similar to regular expressions, but more powerful.  Also, a set of
predefined (named) patterns are provided.  The pattern library is extensible.
Rosie patterns are written in
.B Rosie Pattern Language (RPL).
A shared library,
.BR librosie ,
provides a programmatic interface to rosie in C, Go, Python, Ruby,
Javascript, and other languages that support
.BR libffi .
.B Rosie
can be used for data mining on large data sets, or for the kind of smaller tasks
that
.B grep
and other regex tools are used for.  The output can be plain text, like grep
produces, or can be structured JSON, in the form of a parse tree.  A number of other
output options are available (see below).

.SH LANGUAGE REFERENCE
The RPL Language Reference may be found via the
.URL http://rosie-lang.org "Rosie home page (news, docs, etc.)".

.SH COMMANDS
The primary commands are
.IR match " and " grep "."
Help for a command is obtained using the
.B \-h
option (see below).
.TP
.I config
Print the configuration of the Rosie installation, including build information if available.
.TP
.I expand " exp"
Expands a
.I pattern expression
entered on the command line.  Output is: (1) the expression as entered (which
will show any shell expansions or substitutions); (2) the parsed expression; (3)
what the expression means at top level, where a bare expression is a tokenized
expression; and (4) the result after any macro expansions.
.TP
.I grep " exp [file1 ...]"
In the style of grep, match the given
.I pattern
against lines in the given input files (or the standard input).  In this mode,
the pattern may match anywhere within a line, and all matches within a line are
found.  The default output form in this mode is to print the entire line for all
lines that match.
.TP
.I help
Print help text.
.TP
.IR list " [name[.name]]"
List the available patterns from the library whose name matches
.I name.
To list all the names in an imported package, use
.IR "list pkgname.*" .
.TP
.I match " exp [file1 ...]"
Match the given
.I pattern
against lines in the given input files (or the standard input). Patterns in RPL
begin at the start of the input line. See the
.I grep
command for behavior that is more like that utility.
.TP
.I repl
Enter the read-eval-print loop for interactive development and testing of patterns
.TP
.I test " file1 [...]"
Execute the pattern tests embedded within the listed rpl files.
.TP
.I trace " exp [file1 ...]"
Perform a match, but generate a trace listing of all the steps performed in
the matching process.  This can be quite a lot of output.
.TP
.I version
Print the Rosie version and exit.

.SH GLOBAL OPTIONS
.TP
.BI "\--colors" " colorspecs"
Specify a set of colors and font attributes, each associated with a pattern
name.  The format of
.I colorspecs
is a colon-separated list of
.IR "name=spec",
where
.I spec
is a semi-colon separated list of ANSI (SGR) color and font attributes.  Colors
may be specified by name or integer code.  Attributes include bold, underline,
and others.  The format of
.I name
can be
.I *
for a global default;
.I pkgname.*
for a package default;
.I localname
to match a name exactly, without a prefix; or
.I pkgname.localname
to match an imported name exactly.
.TP
.BI "\-f, \--file" " file"
Load a file of rpl code.  This option may be repeated.
.TP
.BI "\--libpath" " paths"
Set the rosie
.IR "libpath",
which is a colon-separated list of directories to search, in order, for
imported packages.  The value is a colon-separated string.  When the libapth is
not set by the user, Rosie looks for imported packages in the installation
directory, at
.IR "ROSIE_LIBDIR",
the value of which can be seen using the rosie
.I config
command.
.B Important note:
If you set the libpath, you must explicitly include the standard library if you
want Rosie to include the standard library in its search. A
.I libpath
set on the command line takes precedence over one set in an initialization file.  
.TP
.BI "\--norcfile"
Do not load any initialization file.
.TP
.BI "\-o, --output" " style"
Output match data according to
.IR style ,
which may be
.IR color ,
.IR subs ,
.IR matches ,
.IR json ,
.IR line ,
and possibly other (installation-dependent) values.  Use
.B rosie help
to discover what is available in your installation.  Note the default output
style for the
.I match
command is
.IR color ,
and for the
.I grep
command, is
.IR line .
.TP
.BI "\--rcfile" " file"
Load the initialization file specified, instead of the default,
.IR ~/.rosierc .
.TP
.BI "\--rpl" " source"
Define additional patterns, import additional packages.  The argument passed to
.B --rpl
is typically enclosed in single quotes so that Rosie will see it as a single
string with no shell expansions performed.
.TP
.B \--verbose
When appropriate, output additional information.

.SH COMMAND OPTIONS
.TP
.B \-h, \--help
Display help for a command.  This option must be given after the command name, e.g.
.BR "rosie match \-h" .
.TP
.B \-a, \-\-all
Generate some output for all input lines.  Lines that do not match the pattern
are written to stderr, while matched output is written to stdout.
.TP
.B \-w, \-\-wholefile
Match against the whole input file as if it were a single string.
.TP
.B \-F, \-\-fixed\-strings
Interpret
.I pattern
as a set of fixed (literal) strings, instead of an RPL pattern (which reqires
double quotes around string literals).
.TP
.B \-
Stop reading from the given input files, if any, and start reading from the standard input.

.SH ENVIRONMENT
.P
Currently, Rosie does not use any environment variables.  If this would be a
useful addition, please open an issue on Rosie's GitHub repository.
\" .B ROSIE_LIBPATH
\" .TP
\" .B ROSIE_COLORS
\" A colon-separated list of pattern names with ANSI SGR color/attribute options to
\" use when printing matching text.  For example, when "net.any=1;31" is included
\" within ROSIE_COLORS, input text that matches the pattern
\" .I net.any
\" will be printed in bold (1) red (31) text.  ROSIE_COLORS is only consulted when
\" the output style
\" .I color
\" is selected.  ROSIE_COLORS, when set, replaces Rosie's default color settings.

.SH FILES
.TP
.I ~/.rosierc
.B This is the default initialization file, which is loaded before any command line options are processed.  The syntax of
.I .rosierc
is essentially the RPL syntax, with two dashes to start comments, and option
values in double-quoted strings.  Options are set using an assignment-like
syntax, e.g.
.I libpath = "bar:baz"
to set the rosie
.I libpath
to a sequence of two directories,
.IR bar " and"
.IR baz .
The recognized options are:
.RS 10
.IP colors="..." 16
sets
.I colors
to a
.I colorspec
(can be used multiple times; values will be concatenated)
.IP libpath="..." 16
sets
.I libpath
(can be used multiple times; values will be concatenated)
.IP loadfile="..." 16
loads the specified (single) file
(can be used multiple times to load multiple rpl files)
.RE

.SH EXAMPLES
.B Forthcoming

.SH BUGS
Rosie does not normalize Unicode input.  If a pattern contains composed
characters, for example, these will not match their decomposed equivalents in
the input (and vice versa).
.PP
The RPL compiler is slow (but matching is reasonably fast).
.PP
Issues (bugs and enhancement requests) may be found on 
.URL https://github.com/jamiejennings/rosie-pattern-language/issues "Rosie's issue page."
.SH "SEE ALSO"
.URL http://rosie-lang.org "Rosie's home (news, docs, etc.)"
.SH AUTHOR
Jamie A. Jennings
.br
.URL mailto:info@rosie-lang.org "email contact"
.br
.URL https://twitter.com/jamietheriveter "@jamietheriveter"
.PP
With contributions from the people listed in 
.URL https://github.com/jamiejennings/rosie-pattern-language/CONTRIBUTORS "the CONTRIBUTORS file."

